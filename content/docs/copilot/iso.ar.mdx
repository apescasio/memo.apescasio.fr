---
title: Intelligent Systems Optimization
---

## السياق

« **Arise ISO. Please reset the method of authentication for Kdot.** »

لستُ معلماً، هذه ملاحظاتي الخاصة، طالب متواضع، آرون (إيزو) بيسكاسيو.

أصيبت صديقة لي مؤخراً بالتواء في معصمها نتيجة كثرة ممارسة الجمباز، وكنت أتلقى الكثير من الرسائل الصوتية.

ألهمتني هذه التجربة لاستخدام التحكم الصوتي على iPhone وVoice Access على Windows لتنفيذ الأوامر الصوتية عبر وكلاء الذكاء الاصطناعي في Copilot Studio، مما يوفر طريقة أكثر بديهية و"بدون استخدام اليدين" للعمل.

لمن يفضّل المشاهدة: هناك [فيديو يشرح كل شيء خطوة بخطوة](https://www.youtube.com/watch?v=LW2gVkjYrAw).

![Intelligent-Systems-Optimization (ISO)](/images/copilot/iso.png)

## Insignificant Student

كطالب، هدفي هو كسب المال دون إنفاق أي شيء.

لذلك استخدمت [نسخة تجريبية لمدة 30 يوماً من Microsoft 365 Business Premium](https://www.microsoft.com/en-us/microsoft-365/business/microsoft-365-business-premium?activetab=pivot:overviewtab) و[نسخة تجريبية لمدة 30 يوماً من Copilot Studio](https://www.microsoft.com/en-us/thesource-developer/Event/38/sign-up-for-copilot-studio-trial%23:~:text=Sign%2520up%2520for%2520a%2520free,the%2520instructions%2520to%2520get%2520started.).

سواء كان ذلك لاختبار Azure tenant أو Intune أو M365 Copilot AI، فأنا أستغل الوقت المتاح لدي.

## I.S.O AI Agent Copilot Studio

لإنشاء وكيل الذكاء الاصطناعي، أذهب إلى copilotstudio.microsoft.com، هذا هو المكان الذي يمكنك من خلاله إدارة وكلاء الذكاء الاصطناعي.

في هذا الفيديو، سأقوم بإنشاء وكيل ذكي لقسم تكنولوجيا المعلومات، سأطلق عليه اسم ISO.

```txt title="iso-details.txt"

Name: ISO Mark II.

Description: Purpose of ISO (Intelligent Systems Optimization) is to assist with recurring tasks in a semi-automated way—always with a human in the loop. 

This will never be about replacing people or automating every step from A to Z. It’s about empowering individuals to work more efficiently, while preserving the essence of human judgment, creativity, and care.

I believe in coexistence with AI, not domination by it. Just as we learn from different cultures, we can grow alongside intelligent systems. 

AI can help us grow—not replace what makes us human.
```


تستخدم معظم الشركات واجهات برمجة تطبيقات مدفوعة من طرف ثالث لتنفيذ إجراءات مثل إعادة تعيين MFA (المصادقة متعددة العوامل).

توجد أيضاً إجراءات أخرى مثل إعادة تعيين كلمة المرور، حيث يطلب الوكيل من المستخدم أي بريد يحتاج لإعادة تعيين كلمة المرور والبريد الآخر الذي يمكنه استقبال كلمة المرور الفعلية.

سأقوم بتنفيذ إعادة تعيين MFA بطريقة مجانية باستخدام Graph API.

## I.S.O AI Agent Enterprise App

لاستخدام Graph API، أقوم بإنشاء تطبيق مؤسسي في Azure، وأمنحه الحقوق اللازمة لتنفيذ إجراء إعادة تعيين MFA.

ثم أقوم بإنشاء Client Secret وتدوين: Tenant ID + Client ID + Client Secret لأستخدمها في سير عمل الوكيل.

```ps1 title="iso-copilot-ai-agent.ps1"
### © Aaron (Iso) Pescasio / www.apescasio.fr ###

### Suppress module reinstallation errors and general warnings ###

$ErrorActionPreference = "SilentlyContinue"

### Only install Graph SDK if not already present ###

if (-not (Get-Module -ListAvailable -Name Microsoft.Graph)) {
    Install-Module Microsoft.Graph -Scope CurrentUser -Force -AllowClobber
}

### Connect to Microsoft Graph as Global Admin ###

Connect-MgGraph -Scopes "Application.ReadWrite.All", "AppRoleAssignment.ReadWrite.All", "Directory.ReadWrite.All"

### Reset error handling for actual logic ###

$ErrorActionPreference = "Stop"

### Create the application ###

$app = New-MgApplication -DisplayName "ISO AI Agent Copilot"

### Create a Service Principal for the application ###

$sp = New-MgServicePrincipal -AppId $app.AppId

### Get Microsoft Graph Service Principal (target API) ###

$graphSp = Get-MgServicePrincipal -Filter "DisplayName eq 'Microsoft Graph'"

### Define required application permissions ###

$applicationPermissions = @(
    "UserAuthenticationMethod.Read.All",
    "UserAuthenticationMethod.ReadWrite.All"
)

### Resolve permission role IDs (Application roles) ###

$requiredApplicationPermissions = @()
foreach ($perm in $applicationPermissions) {
    $match = $graphSp.AppRoles | Where-Object { $_.Value -eq $perm -and $_.AllowedMemberTypes -contains "Application" }
    if ($match) {
        $requiredApplicationPermissions += @{
            Id   = $match.Id
            Type = "Role"
        }
    } else {
        Write-Warning "Application permission '$perm' not found in Microsoft Graph AppRoles."
    }
}

### Add application permissions to the app registration ###

Update-MgApplication -ApplicationId $app.Id -RequiredResourceAccess @(
    @{
        ResourceAppId  = $graphSp.AppId
        ResourceAccess = $requiredApplicationPermissions
    }
)

### Grant admin consent using raw Graph REST API ###

foreach ($perm in $requiredApplicationPermissions) {
    $body = @{
        principalId = $sp.Id
        resourceId  = $graphSp.Id
        appRoleId   = $perm.Id
    } | ConvertTo-Json -Depth 3

    Invoke-MgGraphRequest -Method POST -Uri "https://graph.microsoft.com/v1.0/servicePrincipals/$($sp.Id)/appRoleAssignments" -Body $body -ContentType "application/json"
}

Write-Host "`nApp 'ISO AI Agent Copilot' created with Application permissions (UserAuthenticationMethod.Read/ReadWrite.All) and admin consent granted successfully." -ForegroundColor Green
```

## Topics AI Agent

كل وكلاء الذكاء الاصطناعي لديهم ما نسميه topics وهي في الأساس تدفقات عمل.

على سبيل المثال، يمكنك إنشاء موضوع يرسل رسالة بريد إلكتروني لشخص ما إذا أرسلت رسالة محددة إلى الوكيل.

في وكيل الخاص بي، أنشأت حتى الآن 4 مواضيع.

## Topic 1 `End Conversation`

أنشأت هذا الموضوع بحيث إذا أرسلت الرسالة: « exit » أو « quit » => سينهي الوكيل المحادثة.

```yaml title="end-conversation.yaml"
### © Aaron (Iso) Pescasio / www.apescasio.fr ###

kind: AdaptiveDialog
beginDialog:
  kind: OnRecognizedIntent
  id: main
  intent:
    triggerQueries:
      - exit
      - quit
      - stop
      - end conversation
      - stark@lethimcook.fr

  actions:
    - kind: SendActivity
      id: sendActivity_zbuT5w
      activity: Quitted conversation.

    - kind: EndConversation
      id: 38Aaio

inputType: {}
outputType: {}
```

## Topic 2 `Global Variables`

هذا الموضوع مخصص لتخزين قيم « Global Variables » مثل Tenant ID وClient ID وClient Secret.

```yaml title="global-variables.yaml"
### © Aaron (Iso) Pescasio / www.apescasio.fr ###

kind: AdaptiveDialog
beginDialog:
  kind: OnRecognizedIntent
  id: main
  intent:
    triggerQueries:
      - Arise

  actions:
    - kind: SetVariable
      id: setVariable_DD7ZyQ
      displayName: Set tenant_id
      variable: Global.tenant_id
      value: fill

    - kind: SetVariable
      id: setVariable_zBkYgf
      displayName: Set client_id
      variable: Global.client_id
      value: fill

    - kind: SetVariable
      id: setVariable_DZw93e
      displayName: Set client_secret
      variable: Global.client_secret
      value: fill

    - kind: SendActivity
      id: sendActivity_XOIb5J
      activity: |-
        Hello, I'm {System.Bot.Name}, your partner in Intelligent Systems Optimization.


        Together, we streamline the routine, so you can focus on what truly matters.


        I’m here to help you with tasks that are:
        - **I**ntelligent: guided by context and purpose!
        - **S**upportive: always keeping you in control!
        - **O**ptimized: focused on making your workflow smoother, not replacing your role!

inputType: {}
outputType: {}
```

## Topic 3 `Reset MFA`

هذا الموضوع مخصص لإجراء إعادة تعيين MFA، حيث أستخدم « Global Variables » وGraph API لتنفيذ الإجراء فعلياً. إذا أرسلت الرسالة Reset MFA إلى الوكيل، فسيتم تنشيط هذا الموضوع المحدد.

```yaml title="reset-mfa.yaml"
### © Aaron (Iso) Pescasio / www.apescasio.fr ###

kind: AdaptiveDialog
beginDialog:
  kind: OnRecognizedIntent
  id: main
  intent:
    triggerQueries:
      - Reset MFA

  actions:
    - kind: Question
      id: question_upn
      interruptionPolicy:
        allowInterruption: true

      variable: init:Topic.upn_mfa
      prompt: "Enter only the UPN that needs to have their MFA reset:"
      entity: StringPrebuiltEntity

    - kind: HttpRequestAction
      id: get_token
      displayName: HTTP Request (Access Token)
      method: Post
      url: ="https://login.microsoftonline.com/"&Global.tenant_id&"/oauth2/v2.0/token"
      headers:
        Content-Type: application/x-www-form-urlencoded

      body:
        kind: RawRequestContent
        contentType: application/x-www-form-urlencoded
        content: ="client_id=" & EncodeUrl(Global.client_id) & "&scope=" & EncodeUrl("https://graph.microsoft.com/.default") & "&client_secret=" & EncodeUrl(Global.client_secret) & "&grant_type=client_credentials"

      response: Topic.token_response
      responseSchema: Any
      errorVariable: Topic.token_error
      responseParse: ${Topic.token_response.access_token}
      responseVariable: Topic.token_response
      responseVariableType: string

    - kind: HttpRequestAction
      id: ASHhXA
      displayName: HTTP Request (Get Methods)
      method: Get
      url: ="https://graph.microsoft.com/v1.0/users/"&Topic.upn_mfa&"/authentication/methods"
      headers:
        Authorization: ="Bearer " &Topic.token_response.access_token

      response: Topic.upn_list_methods
      responseSchema:
        kind: Record
        properties:
          @odata.context: String
          value:
            type:
              kind: Table
              properties:
                @odata.type: String
                createdDateTime: String
                displayName: String
                id: String
                password: Blank

    - kind: SetVariable
      id: setVariable_pC405u
      variable: Topic.upn_has_mfa
      value: "=First(Filter(Topic.upn_list_methods.value,'@odata.type'=\"#microsoft.graph.microsoftAuthenticatorAuthenticationMethod\")).id"

    - kind: ConditionGroup
      id: conditionGroup_rq5Xri
      conditions:
        - id: conditionItem_sbRseB
          condition: =!IsBlank(Topic.upn_has_mfa)
          actions:
            - kind: SendActivity
              id: sendActivity_iGJoqj
              activity: |-
                The user "{Topic.upn_mfa}" currently has the following method of authentication: {First(Filter(Topic.upn_list_methods.value,'@odata.type'="#microsoft.graph.microsoftAuthenticatorAuthenticationMethod")).displayName
                }

      elseActions:
        - kind: SendActivity
          id: sendActivity_donjav
          activity: The user "{Topic.upn_mfa}" currently doesn't have any method of authentication.

        - kind: EndConversation
          id: EbmiOA

    - kind: HttpRequestAction
      id: A3Do2j
      displayName: HTTP Request (Delete)
      method: Delete
      url: "=\"https://graph.microsoft.com/v1.0/users/\" & Topic.upn_mfa & \"/authentication/microsoftAuthenticatorMethods/\" & First(Filter(Topic.upn_list_methods.value,'@odata.type'=\"#microsoft.graph.microsoftAuthenticatorAuthenticationMethod\")).id"
      headers:
        Authorization: ="Bearer " &Topic.token_response.access_token

      response: Topic.upn_mfa_status
      responseSchema: Any

    - kind: SendActivity
      id: sendActivity_a2Dahs
      activity: MFA deleted.

inputType: {}
outputType: {}
```

## Topic 4 `Conversation Start`

الموضوع الرابع يهدف ببساطة إلى تقديم الوكيل عند بداية كل محادثة.

```yaml title ="conversation-start.yaml"
### © Aaron (Iso) Pescasio / www.apescasio.fr ###

kind: AdaptiveDialog
beginDialog:
  kind: OnConversationStart
  id: main
  actions:
    - kind: SendActivity
      id: sendMessage_M0LuhV
      activity:
        text:
          - |-
            Hello, I'm {System.Bot.Name}, your partner in Intelligent Systems Optimization.


            Together, we streamline the routine, so you can focus on what truly matters.


            I’m here to help you with tasks that are:
            - **I**ntelligent: guided by context and purpose!
            - **S**upportive: always keeping you in control!
            - **O**ptimized: focused on making your workflow smoother, not replacing your role!
        speak:
          - Hello and thank you for calling {System.Bot.Name}. Please note that some responses are generated by AI and may require verification for accuracy. How may I help you today?
```

## I.S.O AI Agent Execution

يمكنك الدردشة مع وكيل الذكاء الاصطناعي في Teams ببساطة عبر الذهاب إلى Channels => Teams and Microsoft 365 Copilot => والنقر على See agent in Teams.

يمكنك مشاركته مع مستخدمين آخرين بالنقر على Availability Options.

بعد إرسال عبارة التشغيل (trigger phrase)، سيطلب الوكيل عنوان البريد الإلكتروني للمستخدم الذي يحتاج إلى حذف طريقة المصادقة.

سيقوم الوكيل بعد ذلك باستخدام تطبيق Azure للمصادقة والتحقق مما إذا كان لدى المستخدم طريقة حالية أم لا؛ إذا وُجدت فسيتم حذفها، وإذا لم تُوجد فسيتم إعلامك بأن لا طرق مصادقة موجودة. هذا كل شيء.

## Experimental Topic `Reset MFA for Kdot`

بدلاً من كتابة البريد الإلكتروني يدوياً في كل مرة، أنشأت موضوعاً يحتوي على عبارة تشغيل ومتغيرات مخصصة لـ Kdot. هذا نهج يدوي للغاية وغير مثالي، إنه مجرد تجربة.

```yaml title="reset-mfa-for-kdot.yaml"
### © Aaron (Iso) Pescasio / www.apescasio.fr ###

kind: AdaptiveDialog
beginDialog:
  kind: OnRecognizedIntent
  id: main
  intent:
    triggerQueries:
      - Arise ISO. Please reset the method of authentication for Kdot

  actions:
    - kind: SetVariable
      id: setVariable_k6VUkG
      variable: Topic.upn_mfa
      value: kdot@lethimcook.fr

    - kind: HttpRequestAction
      id: get_token
      displayName: HTTP Request (Access Token)
      method: Post
      url: ="https://login.microsoftonline.com/"&Global.tenant_id&"/oauth2/v2.0/token"
      headers:
        Content-Type: application/x-www-form-urlencoded

      body:
        kind: RawRequestContent
        contentType: application/x-www-form-urlencoded
        content: ="client_id=" & EncodeUrl(Global.client_id) & "&scope=" & EncodeUrl("https://graph.microsoft.com/.default") & "&client_secret=" & EncodeUrl(Global.client_secret) & "&grant_type=client_credentials"

      response: Topic.token_response
      responseSchema: Any
      errorVariable: Topic.token_error
      responseParse: ${Topic.token_response.access_token}
      responseVariable: Topic.token_response
      responseVariableType: string

    - kind: HttpRequestAction
      id: ASHhXA
      displayName: HTTP Request (Get Methods)
      method: Get
      url: ="https://graph.microsoft.com/v1.0/users/"&Topic.upn_mfa&"/authentication/methods"
      headers:
        Authorization: ="Bearer " &Topic.token_response.access_token

      response: Topic.upn_list_methods
      responseSchema:
        kind: Record
        properties:
          @odata.context: String
          value:
            type:
              kind: Table
              properties:
                @odata.type: String
                createdDateTime: String
                displayName: String
                id: String
                password: Blank

    - kind: SetVariable
      id: setVariable_pC405u
      variable: Topic.upn_has_mfa
      value: "=First(Filter(Topic.upn_list_methods.value,'@odata.type'=\"#microsoft.graph.microsoftAuthenticatorAuthenticationMethod\")).id"

    - kind: ConditionGroup
      id: conditionGroup_rq5Xri
      conditions:
        - id: conditionItem_sbRseB
          condition: =!IsBlank(Topic.upn_has_mfa)
          actions:
            - kind: SendActivity
              id: sendActivity_iGJoqj
              activity: |-
                The user "{Topic.upn_mfa}" currently has the following method of authentication: {First(Filter(Topic.upn_list_methods.value,'@odata.type'="#microsoft.graph.microsoftAuthenticatorAuthenticationMethod")).displayName
                }

      elseActions:
        - kind: SendActivity
          id: sendActivity_donjav
          activity: The user "{Topic.upn_mfa}" currently doesn't have any method of authentication.

        - kind: EndConversation
          id: EbmiOA

    - kind: HttpRequestAction
      id: A3Do2j
      displayName: HTTP Request (Delete)
      method: Delete
      url: "=\"https://graph.microsoft.com/v1.0/users/\" & Topic.upn_mfa & \"/authentication/microsoftAuthenticatorMethods/\" & First(Filter(Topic.upn_list_methods.value,'@odata.type'=\"#microsoft.graph.microsoftAuthenticatorAuthenticationMethod\")).id"
      headers:
        Authorization: ="Bearer " &Topic.token_response.access_token

      response: Topic.upn_mfa_status
      responseSchema: Any

    - kind: SendActivity
      id: sendActivity_a2Dahs
      activity: MFA deleted.

inputType: {}
outputType: {}
```

## iOS Voice Control 

استخدمت ميزة Vocabulary في إعدادات التحكم الصوتي على iPhone لتكييفها مع صوتي.

**Settings => Accessibility => Voice Control => Vocabulary**

« **يجب أن نتخيل سيزيف سعيداً.** »

كما قمت أيضاً بتفعيل Accessibility Shortcut.

**Settings => Accessibility => Accessibility Shortcut => Voice Control**

## Windows Voice Access

تتوفر نفس الميزات في Windows عبر Voice Access.

**Windows key => Shift => S key**

## I.S.O AI Agent Restrictions on VIP Accounts

لمنع الوكيل من التعامل مع حسابات الشخصيات المهمة (VIP)، قمت ببساطة بإضافة بريد المستخدم إلى موضوع « End Conversation ». هذا يعني أنه إذا حاول أحدهم إعادة تعيين MFA للحساب stark@lethimcook.fr => سينهي الوكيل المحادثة.

## Post I.S.O AI Agent Ramblings

هدفي هو التعايش مع الذكاء الاصطناعي بنفس الطريقة التي نتشارك ونتعلم بها من ثقافات مختلفة في عالمنا. يمكن للذكاء الاصطناعي مساعدتنا على النمو دون أن يحل محل ما يجعلنا بشراً.

أفضل نصيحة أتبعها بنفسي مرة كل شهر هي تفكيك كل شيء وإعادة بنائه مراراً وتكراراً.

مرة كل شهر، أعيد تهيئة جهاز الكمبيوتر الخاص بي وأعيد كل شيء عبر PowerShell.

مرة كل شهر، أكسر بيئة المختبر الخاصة بي وأقوم بكل شيء مرة أخرى، سواء كان ذلك إنشاء وكلاء Copilot AI أو إعداد Autopilot كامل عبر Intune في السحابة.

ما زلت أتعلم في الدورة السادسة، وسأستمر في التعلم في الدورة السابعة والثامنة والتاسعة وهكذا.

التكرار هو ببساطة أم التعلم.

كل ما عرضته حتى الآن يبقى يدوياً، لكني سأجد حلاً بنهاية هذه الدورة أو في الدورة التالية.

في الفيديو القادم عن الذكاء الاصطناعي، أخطط لإنشاء وكيل Copilot لقسم الموارد البشرية، يركز على الأسئلة المتكررة مثل: « حالياً، كم عدد أيام الإجازة المدفوعة التي يمكنني تقديمها لرئيسي؟ »، وهكذا.

إذا كنت ترغب في البدء في مجال تكنولوجيا المعلومات أو الذكاء الاصطناعي، فلا تتردد في الاطلاع على بعض ملاحظاتي => https://memo.apescasio.fr !

للاستفسارات المهنية، بريدي الإلكتروني هو him@apescasio.fr !

للاستفسارات الشخصية يمكنك التواصل معي عبر Discord / Instagram / Twitter، @himapescasio.